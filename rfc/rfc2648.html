<pre>






Network Working Group                                           R. Moats
Request for Comments: 2648                                          AT&amp;T
Category: Informational                                      August 1999


                   A URN Namespace for IETF Documents

Status of this Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (1999).  All Rights Reserved.

Abstract

   A system for Uniform Resource Names (URNs) must be capable of
   supporting new naming systems.  As an example of proposing a new
   namespace, this document proposes the &quot;ietf&quot; namespace.  This
   namespace consists of the RFC family of documents (RFCs, STDs, FYIs,
   and BCPs) developed by the IETF and published by the RFC Editor, the
   minutes of working groups (WG) and birds of a feather (BOF) meetings
   that occur during IETF conferences, and the Internet Drafts published
   by the Internet Drafts Editor.  Both the current URN framework and
   URN syntax support this namespace.

1. Introduction

   This document proposes the &quot;ietf&quot; namespace, which consists of the
   RFC family of documents (RFCs, STDs, FYIs, and BCPs) developed by the
   IETF and published by the RFC editor and the minutes of working
   groups (WG) and birds of a feather (BOF) meetings that occur during
   IETF conferences.

   The namespace specification is for a formal namespace.

2. Specification Template

      Namespace ID:

            &quot;ietf&quot; requested.







Moats                        Informational                      [Page 1]

RFC 2648           A URN Namespace for IETF Documents        August 1999


      Registration Information:

            Registration version number: 1
            Registration date: 1999-04-22

      Declared registrant of the namespace:

            Ryan Moats
            jayhawk@att.com
            AT&amp;T
            15621 Drexel Circle
            Omaha, NE 68135-2358

      Declaration of structure:

            The identifier has the following ABNF [2] specification:

            NSS = rfc-nss / fyi-nss / std-nss / bcp-nss /
                  draft-nss / mtg-nss / other-nss

            rfc-nss = &quot;rfc:&quot; 1*DIGIT
            fyi-nss = &quot;fyi:&quot; 1*DIGIT
            std-nss = &quot;std:&quot; 1*DIGIT
            bcp-nss = &quot;bcp:&quot; 1*DIGIT
            draft-nss = &quot;id:&quot; string
            mtg-nss = &quot;mtg:&quot; string
            other-nss = string
              ; beginning with a prefix other than one of those
              ; above for future expansion

            string = 1*(DIGIT / ALPHA / &quot;-&quot;)

            If the IESG (or it successor) adds a new document series,
            this ABNF specification will need to be updated.  Further,
            if a working group or BOF is created that used characters
            outside the range of this ABNF specification, this
            specification will need to be updated.  Any system intended
            to resolve names for this namespace should be written with
            the awareness that this could occur at any time.

      Relevant ancillary documentation:

            Relevant documentation is in RFC 2648.








Moats                        Informational                      [Page 2]

RFC 2648           A URN Namespace for IETF Documents        August 1999


      Identifier uniqueness considerations:

            Because the rfc-editor assigns the RFC number uniquely these
            URNs are unique.  Since the mapping between RFCs and other
            rfc-editor document series (STDs, FYIs or BCPs) is not
            necessarily one-to-one, uniqueness of STDs, FYIs and BCPs
            are defined based on the document mappings maintained by the
            RFC Editor (the index files &quot;rfc-index.txt&quot;, &quot;fyi-
            index.txt&quot;, &quot;bcp-index.txt&quot;, &quot;std-index.txt&quot;) are defined to
            be the definitive statement of the assignment of RFC Family
            URNs in this namespace.  The meeting minutes portion of the
            namespace is guaranteed unique because the URN includes the
            sequence number of the IETF conference.  The document
            mapping maintained by the Internet Drafts editor (&quot;1id-
            abstracts.txt&quot;) is defined as the definitive statement of
            the assignment of URNs for the internet draft portion of
            this namespace.

      Identifier persistence considerations:

            Persistence of the URNs of this namespace is independent of
            the mutability of the underlying documents.  A URN once
            assigned will never be reassigned to a different resource;
            the assignment is persistent and immutable.  Immutability of
            RFCs, STDs, FYIs and BCPs is at the discretion of the RFC
            Editor.  They may be composites of one or more RFCs and the
            set of RFCs that includes them may change with time.  It is
            important to note that this mutability of some resources is
            independent of the immutability of URN assignment to a
            resource.

      Process of identifier assignment:

            Assignment of URNs from this namespace occurs in three ways.
            The first is through publication of a new RFC, FYI, STD or
            BCP is by the RFC Editor. This new document will have a new
            series number and will therefore define a new URN.  The
            document mappings maintained by the RFC Editor (the index
            files &quot;rfc-index.txt&quot;, &quot;fyi-index.txt&quot;, &quot;bcp-index.txt&quot; and
            &quot;std-index.txt&quot;) are defined to be the definitive statement
            of the assignment of RFC Family URNs in this namespace.

            The second way a URN is assigned is through the filing of
            meeting minutes by a working group or birds of a feather as
            part of an IETF conference.  The list of minutes maintained
            by the IETF for each working group and conference in the
            subtree pointed at by the URL ftp://ietf.org/ietf/ is
            considered the definitive assignment of URNs for working



Moats                        Informational                      [Page 3]

RFC 2648           A URN Namespace for IETF Documents        August 1999


            group or birds of a feather minutes.

            The third way a URN is assigned is through the publication
            of a new internet-draft by the Internet Draft Editor.  This
            draft will have a distinct name (and version number) and
            therefore defined a new URN.  The document mapping
            maintained by the Internet Drafts editor (&quot;1id-
            abstracts.txt&quot;) is defined as the definitive statement of
            the assignment of URNs for this portion of the namespace.

      Process of identifier resolution:

            A mirrored copy of the underlying documentation is required
            to resolve these URNs.  Resolution via HTTP is done by a set
            of simple Perl cgi-bin scripts presented in Appendix A.

      Rules for Lexical Equivalence:

            The entire URN is case-insensitive.

      Conformance with URN Syntax:

            There are no additional characters reserved.

      Validation mechanism:

            None additional to resolution specified

      Scope:

            Global.

3. Examples

   The following are examples of URNs that a resolver for this namespace
   can resolve:

         urn:ietf:rfc:2141
         urn:ietf:std:50
         urn:ietf:id:ietf-urn-ietf-06
         urn:ietf:mtg:41-urn










Moats                        Informational                      [Page 4]

RFC 2648           A URN Namespace for IETF Documents        August 1999


4. Security Considerations

   Because this namespace defines no additional reserved characters, it
   does not add any security considerations beyond those inherent from
   the existence of the reserved characters from [1].  Further, none of
   the reserved characters from [1] are used in the definition of the
   NSS. This means that resolvers for this namespace may be considered
   &quot;secure&quot; in the sense that any escaping of characters in the NSS MUST
   result in the resolver indicating that the URN has incorrect syntax.

5. Acknowledgments

   Thanks to various members of the URN working group for comments on
   earlier drafts of this document.  The work described in this document
   is partially supported by the National Science Foundation,
   Cooperative Agreement NCR-9218179.

6. References

   Request For Comments (RFC) and Internet Draft documents are available
   from numerous mirror sites.

   [1]  Moats, R., &quot;URN Syntax&quot;, RFC 2141, May 1997.

   [2]  Crocker, D. and P. Overell, &quot;Augmented BNF for Syntax
        Specifications: ABNF&quot;, RFC 2234, November 1997.

7. Author&#39;s Address

   Ryan Moats
   AT&amp;T
   15621 Drexel Circle
   Omaha, NE 68135-2358
   USA

   EMail:  jayhawk@att.com















Moats                        Informational                      [Page 5]

RFC 2648           A URN Namespace for IETF Documents        August 1999


Appendix A.  Example Resolution Scripts

   The following scripts are examples that can be used for resolving
   URNs in this namespace.

A.1 I2C

#!/usr/local/bin/perl

use strict;

#
# this is a URN 2 URC resolver for the ietf namespace
#

my(%cite) = (
  bcp =&gt; &quot;/ftp/rfc/bcp-index.txt&quot;,
  fyi =&gt; &quot;/ftp/fyi/fyi-index.txt&quot;,
  id =&gt; &quot;/ftp/internet-drafts/1id-abstracts.txt&quot;,
  rfc =&gt; &quot;/ftp/rfc/rfc-index.txt&quot;,
  std =&gt; &quot;/ftp/std/std-index.txt&quot;
);
my(%number2date) = (
  44 =&gt; &quot;99mar&quot;,
  43 =&gt; &quot;98dec&quot;, 42 =&gt; &quot;98aug&quot;, 41 =&gt; &quot;98apr&quot;,
  40 =&gt; &quot;97dec&quot;, 39 =&gt; &quot;97aug&quot;, 38 =&gt; &quot;97apr&quot;,
  37 =&gt; &quot;96dec&quot;, 36 =&gt; &quot;96jun&quot;, 35 =&gt; &quot;96mar&quot;,
  34 =&gt; &quot;95dec&quot;, 33 =&gt; &quot;95jul&quot;, 32 =&gt; &quot;95apr&quot;,
  31 =&gt; &quot;94dec&quot;, 30 =&gt; &quot;94jul&quot;, 29 =&gt; &quot;94mar&quot;,
  28 =&gt; &quot;93nov&quot;, 27 =&gt; &quot;93jul&quot;, 26 =&gt; &quot;93mar&quot;,
  25 =&gt; &quot;92nov&quot;, 24 =&gt; &quot;92jul&quot;, 23 =&gt; &quot;92mar&quot;,
  22 =&gt; &quot;91nov&quot;, 21 =&gt; &quot;91jul&quot;, 20 =&gt; &quot;91mar&quot;,
  19 =&gt; &quot;90dec&quot; );

my($wgpath) = &quot;/ftp/ietf&quot;;
my($urn) = $ENV{&#39;QUERY_STRING&#39;};
my($host) = $ENV{&#39;SERVER_NAME&#39;}; #get my host name for ftp: URLs
my($accept) = $ENV{&#39;HTTP_ACCEPT&#39;}; #this is the &quot;Accept:&quot; HTTP header

(&amp;resolveid($1), exit) if ($urn =~ /urn:ietf:id:(\S+)/i);
(&amp;resolverfc($1, $2), exit) if ($urn =~ /urn:ietf:(\w*):(\d*)/i);
(&amp;resolvemtg($1, $2), exit) if ($urn =~ /urn:ietf:mtg:(\d*)-(\w*)/i);
&amp;urn_error(&quot;400 Bad Request\n&quot;);

sub resolvemtg {
  my($ietfnum, $sesnam) = @_;
  &amp;urn_error(&quot;404 Not Found\n&quot;) if (!defined $number2date{$ietfnum});
  my($date)=$number2date{$ietfnum};



Moats                        Informational                      [Page 6]

RFC 2648           A URN Namespace for IETF Documents        August 1999


  my($link)=&quot;$wgpath/$sesnam/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
    print &quot;Status:  200 OK\r\n&quot;;
    print &quot;Content-type: text/html\r\n\r\n&quot;;
    print &quot;&lt;HTML&gt;\n&lt;TITLE&gt;Citation for $urn&lt;/TITLE&gt;\n&quot;;
    print &quot;&lt;BODY&gt;\n&quot;;
    print &quot;&lt;H1&gt;&lt;A HREF=\&quot;$link\&quot;&gt;$urn&lt;/A&gt;:&lt;/H1&gt;\n&quot;;
    print &quot;Minutes of the $sesnam working group from the &quot;
          . &amp;end($ietfnum) . &quot; IETF&quot;;
    print &quot;&lt;/BODY&gt;\n&lt;/HTML&gt;\n&quot;;
    return;
  }
  my($link)=&quot;$wgpath/$date/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
    print &quot;Status:  200 OK\r\n&quot;;
    print &quot;Content-type: text/html\r\n\r\n&quot;;
    print &quot;&lt;HTML&gt;\n&lt;TITLE&gt;Citation for $urn&lt;/TITLE&gt;\n&quot;;
    print &quot;&lt;BODY&gt;\n&quot;;
    print &quot;&lt;H1&gt;&lt;A HREF=\&quot;$link\&quot;&gt;$urn&lt;/A&gt;:&lt;/H1&gt;\n&quot;;
    print &quot;Minutes of the $sesnam working group from the &quot;
           . &amp;end($ietfnum) . &quot; IETF&quot;;
    print &quot;&lt;/BODY&gt;\n&lt;/HTML&gt;\n&quot;;
    return;
  }
  &amp;urn_error(&quot;404 Not Found\n&quot;);
}

sub end {
  my($inarg)=@_;
  return $inarg . &quot;st&quot; if ($inarg =~ /1$/);
  return $inarg . &quot;nd&quot; if ($inarg =~ /2$/);
  return $inarg . &quot;rd&quot; if ($inarg =~ /3$/);
  return $inarg . &quot;th&quot;;
}

sub resolverfc {
  my($flag,@bib,$i,$k,$j,$done,@ref);
  my($l,$link);
  my($scheme, $value) = @_;
  $scheme =~ tr/A-Z/a-z/;
  if (!defined $cite{$scheme}) {
    &amp;urn_error(&quot;404 Not Found\n&quot;);
  }

  $flag = 0;
  open(INPUT, &quot;$cite{$scheme}&quot;);
  while (&lt;INPUT&gt;) {
    $flag = 1 if (/^0*$value /);



Moats                        Informational                      [Page 7]

RFC 2648           A URN Namespace for IETF Documents        August 1999


    if ($flag == 1) {
      last if (/^$/);
      chop;
      push @bib,$_;
    }
  }

  if ($scheme ne &quot;rfc&quot;) {
    print &quot;Status:  200 OK\r\n&quot;;
    print &quot;Content-type: text/html\r\n\r\n&quot;;
    $bib[0] =~ s/^[0-9]*\s*/&lt;B&gt;/;
    for ($i=0; $i&lt;=$#bib; $i+=1) {
      last if ($bib[$i] =~ s/\./.&lt;\/B&gt;/);
    }
    for ($i=0;$i&lt;=$#bib;$i+=1) {
      $k=$bib[$i];
      while ($k =~ /(fyi|std|rfc|bcp)([0-9]+)(.*)/i) {
        push @ref,&quot;$1$2&quot;;
        $k=$3;
      }
      $done=&quot;&quot;;
      foreach $j (@ref) {
        next if ($done =~ $j);
        $done .= &quot;$j &quot;;
        $l = $j;
        $l =~ tr/A-Z/a-z/;
        $link=&amp;make_link(&quot;$l&quot;);
        $bib[$i] =~ s/$j/&lt;A HREF=&quot;$link&quot;&gt;$j&lt;\/A&gt;/g;
      }
    }
    print &quot;&lt;HTML&gt;\n&lt;TITLE&gt;Citation for $urn&lt;/TITLE&gt;\n&quot;;
    print &quot;&lt;BODY&gt;\n&quot;;
    $link=&amp;make_link(&quot;$scheme$value&quot;);
    print &quot;&lt;H1&gt;&lt;A HREF=\&quot;$link\&quot;&gt;$scheme$value&lt;/A&gt;:&lt;/H1&gt;\n&quot;;
    foreach $i (@bib) {
      print &quot;$i\n&quot;;
    }
    print &quot;&lt;/BODY&gt;\n&lt;/HTML&gt;\n&quot;;
  } else {
    print &quot;Status:  200 OK\r\n&quot;;
    print &quot;Content-type: text/html\r\n\r\n&quot;;
    $bib[0] =~ s/^[0-9]*\s*//;
    $j=0;
    for ($i=0; $i&lt;=$#bib; $i+=1) {
      $j += ($bib[$i] =~ s/, &quot;/, &lt;B&gt;&quot;/);
      $j += ($bib[$i] =~ s/&quot;,/&quot;&lt;\/B&gt;,/);
    }
    for ($i=0;$i&lt;=$#bib;$i+=1) {



Moats                        Informational                      [Page 8]

RFC 2648           A URN Namespace for IETF Documents        August 1999


      $k=$bib[$i];
      while ($k =~ /(fyi\s|std\s|rfc|bcp)([0-9]+)(.*)/i) {
        push @ref,&quot;$1$2&quot;;
        $k=$3;
      }
      $done=&quot;&quot;;
      foreach $j (@ref) {
        next if ($done =~ $j);
        $done .= &quot;$j &quot;;
        $l = $j;
        $l =~ s/\s//g;
        $l =~ tr/A-Z/a-z/;
        $link=&amp;make_link(&quot;$l&quot;);
        $bib[$i] =~ s/$j/&lt;A HREF=&quot;$link&quot;&gt;$j&lt;\/A&gt;/g;
      }
    }
    print &quot;&lt;HTML&gt;\n&lt;TITLE&gt;Citation for $urn&lt;/TITLE&gt;\n&quot;;
    print &quot;&lt;BODY&gt;\n&quot;;
    $link=&amp;make_link(&quot;$scheme$value&quot;);
    print &quot;&lt;H1&gt;&lt;A HREF=\&quot;$link\&quot;&gt;$scheme$value&lt;/A&gt;:&lt;/H1&gt;\n&quot;;
    foreach $i (@bib) {
      print &quot;$i\n&quot;;
    }
    print &quot;&lt;/BODY&gt;\n&lt;/HTML&gt;\n&quot;;
  }
}

sub make_link {
  my($sc);
  my($inarg)=@_;
  ($sc=$1) if ($inarg =~ /([a-z]*)/);
  return &quot;/$sc/$inarg.ps&quot; if (-e &quot;/ftp/$sc/$inarg.ps&quot;);
  return &quot;/$sc/$inarg.html&quot; if (-e &quot;/ftp/$sc/$inarg.html&quot;);
  return &quot;/$sc/$inarg.txt&quot;;
}

sub urn_error {
  my($code) = @_; #store failure code here...

  print &quot;Status:  $code&quot;;
  print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
  print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2C $code&lt;/title&gt;&lt;/head&gt;\n&quot;;
  print &quot;&lt;BODY&gt;\n&quot;;
  print &quot;&lt;h1&gt;URN to URC resolution failed for the URN:&lt;/h1&gt;\n&quot;;
  print &quot;&lt;hr&gt;&lt;h3&gt;$urn&lt;/h3&gt;\n&quot;;
  print &quot;&lt;/body&gt;\n&quot;;
  print &quot;&lt;/html&gt;\n&quot;;
  exit;



Moats                        Informational                      [Page 9]

RFC 2648           A URN Namespace for IETF Documents        August 1999


};

sub resolveid {
  my($flag,@bib,$i,$k,$j,$count,@ref);
  my($l,$link, $hdr, $done);
  my($value) = @_;
  my($scheme) = &quot;id&quot;;

  open(INPUT, &quot;$cite{$scheme}&quot;);
  while (&lt;INPUT&gt;) {
#
# capture record
#
    if ($flag == 1 || /^\s+\&quot;/) {
      push @bib,$_;
      ($hdr = -1, $count = 0, $flag = 1) if (/^\s+\&quot;/);
      $count++ if (/^\s+$/);
    }
    if ($count == 1) {
      $hdr = $#bib if ($hdr == -1);
    }
    if ($count == 2) {
      for ($i=0; $i&lt;=$hdr; $i+=1) {
            if ($bib[$i] =~ /&lt;(.*)&gt;/) {
              $l = $1;
              if ($l eq &quot;draft-$value.txt&quot; || $l eq &quot;draft-$value.ps&quot;) {
                print &quot;Status:  200 OK\r\n&quot;;
                print &quot;Content-type: text/html\r\n\r\n&quot;;
                print &quot;&lt;HTML&gt;\n&lt;TITLE&gt;Citation for $urn&lt;/TITLE&gt;\n&quot;;
                print &quot;&lt;BODY&gt;\n&quot;;
                print &quot;&lt;a
href=\&quot;http://blackhole.vip.att.net/internet-drafts/$l\&quot;&gt;$l&lt;/a&gt;:\n&quot;;
                print &quot;&lt;pre&gt;\n&quot;;
                foreach $i (@bib) {
                  print &quot;$i&quot;;
                }
                print &quot;&lt;/pre&gt;\n&quot;;
                print &quot;&lt;/BODY&gt;\n&lt;/HTML&gt;\n&quot;;
                exit;
              }
            }
      }
      $flag = 0;
      @bib = ();
    }
  }
  &amp;urn_error(&quot;404 Not Found\n&quot;);
}



Moats                        Informational                     [Page 10]

RFC 2648           A URN Namespace for IETF Documents        August 1999


A.2 I2L

#!/usr/local/bin/perl

use strict;

#
# this is a URN 2 URL resolver for the ietf namespace
#

my(%pathbase) = (
  rfc =&gt; &quot;rfc/rfc&quot;,
  fyi =&gt; &quot;fyi/fyi&quot;,
  std =&gt; &quot;std/std&quot;,
  bcp =&gt; &quot;bcp/bcp&quot;,
  id =&gt; &quot;internet-drafts/draft-&quot;
);

my(%number2date) = (
  44 =&gt; &quot;99mar&quot;,
  43 =&gt; &quot;98dec&quot;, 42 =&gt; &quot;98aug&quot;, 41 =&gt; &quot;98apr&quot;,
  40 =&gt; &quot;97dec&quot;, 39 =&gt; &quot;97aug&quot;, 38 =&gt; &quot;97apr&quot;,
  37 =&gt; &quot;96dec&quot;, 36 =&gt; &quot;96jun&quot;, 35 =&gt; &quot;96mar&quot;,
  34 =&gt; &quot;95dec&quot;, 33 =&gt; &quot;95jul&quot;, 32 =&gt; &quot;95apr&quot;,
  31 =&gt; &quot;94dec&quot;, 30 =&gt; &quot;94jul&quot;, 29 =&gt; &quot;94mar&quot;,
  28 =&gt; &quot;93nov&quot;, 27 =&gt; &quot;93jul&quot;, 26 =&gt; &quot;93mar&quot;,
  25 =&gt; &quot;92nov&quot;, 24 =&gt; &quot;92jul&quot;, 23 =&gt; &quot;92mar&quot;,
  22 =&gt; &quot;91nov&quot;, 21 =&gt; &quot;91jul&quot;, 20 =&gt; &quot;91mar&quot;,
  19 =&gt; &quot;90dec&quot; );

my($wgpath) = &quot;/ftp/ietf&quot;;
my($urn) = $ENV{&#39;QUERY_STRING&#39;};
my($host) = $ENV{&#39;SERVER_NAME&#39;}; #get my host name for ftp: URLs
my($accept) = $ENV{&#39;HTTP_ACCEPT&#39;}; #this is the &quot;Accept:&quot; HTTP header

(&amp;resolveid($1), exit) if ($urn =~ /urn:ietf:id:(\S+)/i);
(&amp;resolverfc($1, $2), exit) if ($urn =~ /urn:ietf:(\w*):(\d*)/i);
(&amp;resolvemtg($1, $2), exit) if ($urn =~ /urn:ietf:mtg:(\d*)-(\w*)/i);
&amp;urn_error(&quot;400 Bad Request\n&quot;);

sub resolvemtg {
  my($ietfnum, $sesnam) = @_;
  &amp;urn_error(&quot;404 Not Found\n&quot;) if (!defined $number2date{$ietfnum});
  my($date)=$number2date{$ietfnum};
  my($link)=&quot;$wgpath/$sesnam/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
    print &quot;Status:  302 Moved temporarily\n&quot;;
    print &quot;Location: $link\n&quot;;



Moats                        Informational                     [Page 11]

RFC 2648           A URN Namespace for IETF Documents        August 1999


    return;
  }
  my($link)=&quot;$wgpath/$date/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
    print &quot;Status:  302 Moved temporarily\n&quot;;
    print &quot;Location: $link\n&quot;;
    return;
  }
  &amp;urn_error(&quot;404 Not Found\n&quot;);
}

sub end {
  my($inarg)=@_;
  return $inarg . &quot;st&quot; if ($inarg =~ /1$/);
  return $inarg . &quot;nd&quot; if ($inarg =~ /2$/);
  return $inarg . &quot;rd&quot; if ($inarg =~ /3$/);
  return $inarg . &quot;th&quot;;
}

sub resolverfc {
  my($flag,@bib,$i,$k,$j,$done,@ref);
  my($l,$link);
  my($scheme, $value) = @_;
  $scheme =~ tr/A-Z/a-z/;
  &amp;urn_error(&quot;404 Not Found\n&quot;)if (!defined $pathbase{$scheme});
  my($txttry)=&quot;/ftp/$pathbase{$scheme}$value.txt&quot;;
  my($pstry)=&quot;/ftp/$pathbase{$scheme}$value.ps&quot;;
  my($htmltry)=&quot;/ftp/$pathbase{$scheme}$value.html&quot;;
MIME_SWITCH: {
    if ($accept =~ /application\/postscript/ &amp;&amp; -f $pstry) {
      print &quot;Status:  302 Moved temporarily\n&quot;;
      print &quot;Location: http://$host/$pathbase{$scheme}$value.ps\n\n&quot;;
      last MIME_SWITCH;
    }
    if ($accept =~ /text\/html/ &amp;&amp; -f $htmltry) {
<font color='red'><s>
      print &quot;Status:  302 Moved temporarily0;
      </s></font></pre><div style='overflow:auto;border:dashed;margin:8px;padding:24px;background-color:#FFFFAF;'><b><i>The preceding text has been updated by Technical <a href='https://www.rfc-editor.org/errata/eid3145'>Errata 3145</a> to instead read:</i></b><pre style='margin:20px'>

      print &quot;Status:  302 Moved temporarily&quot;;
</pre><i><b>Errata Notes: </b>

might be both editorial and technical error (typo, causing the Perl code invalid)

</i></div><pre>
print &quot;Location: http://$host/$pathbase{$scheme}$value.html\n\n&quot;;
      last MIME_SWITCH;
    }
    if ($accept =~ /\*\/\*|text\/plain/ &amp;&amp; -f $txttry) {
      print &quot;Status:  302 Moved temporarily\n&quot;;
      print &quot;Location: http://$host/$pathbase{$scheme}$value.txt\n\n&quot;;
      last MIME_SWITCH;
    }
    &amp;urn_error(&quot;404 Not Found\n&quot;);
  }
}




Moats                        Informational                     [Page 12]

RFC 2648           A URN Namespace for IETF Documents        August 1999


sub urn_error {
  my($code) = @_; #store failure code here...

  print &quot;Status:  $code&quot;;
  print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
  print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2L $code&lt;/title&gt;&lt;/head&gt;\n&quot;;
  print &quot;&lt;BODY&gt;\n&quot;;
  print &quot;&lt;h1&gt;URN to URL resolution failed for the URN:&lt;/h1&gt;\n&quot;;
  print &quot;&lt;hr&gt;&lt;h3&gt;$urn&lt;/h3&gt;\n&quot;;
  print &quot;&lt;/body&gt;\n&quot;;
  print &quot;&lt;/html&gt;\n&quot;;
  exit;
}

sub resolveid {
  my($flag,@bib,$i,$k,$j,$done,@ref);
  my($l,$link);
  my($scheme) = &quot;id&quot;;
  my($value) = @_;
  $scheme =~ tr/A-Z/a-z/;
  &amp;urn_error(&quot;404 Not Found\n&quot;)if (!defined $pathbase{$scheme});
  my($txttry)=&quot;/ftp/$pathbase{$scheme}$value.txt&quot;;
  my($pstry)=&quot;/ftp/$pathbase{$scheme}$value.ps&quot;;
  my($htmltry)=&quot;/ftp/$pathbase{$scheme}$value.html&quot;;
MIME_SWITCH: {
    if ($accept =~ /application\/postscript/ &amp;&amp; -f $pstry) {
      print &quot;Status:  302 Moved temporarily\n&quot;;
      print &quot;Location: http://$host/$pathbase{$scheme}$value.ps\n\n&quot;;
      last MIME_SWITCH;
    }
    if ($accept =~ /text\/html/ &amp;&amp; -f $htmltry) {
      print &quot;Status:  302 Moved temporarily\n&quot;;
      print &quot;Location: http://$host/$pathbase{$scheme}$value.html\n\n&quot;;
      last MIME_SWITCH;
    }
    if ($accept =~ /\*\/\*|text\/plain/ &amp;&amp; -f $txttry) {
      print &quot;Status:  302 Moved temporarily\n&quot;;
      print &quot;Location: http://$host/$pathbase{$scheme}$value.txt\n\n&quot;;
      last MIME_SWITCH;
    }
    &amp;urn_error(&quot;404 Not Found\n&quot;);
  }
}








Moats                        Informational                     [Page 13]

RFC 2648           A URN Namespace for IETF Documents        August 1999


A.3 I2Ls

#!/usr/local/bin/perl

use strict;

#
# this is a URN 2 URLs resolver for the ietf namespace
#

my(@urls);

my(%pathbase) = (
  rfc =&gt; &quot;rfc/rfc&quot;,
  fyi =&gt; &quot;fyi/fyi&quot;,
  std =&gt; &quot;std/std&quot;,
  bcp =&gt; &quot;bcp/bcp&quot;,
  id =&gt; &quot;internet-drafts/draft-&quot;
);

my(%number2date) = (
  44 =&gt; &quot;99mar&quot;,
  43 =&gt; &quot;98dec&quot;, 42 =&gt; &quot;98aug&quot;, 41 =&gt; &quot;98apr&quot;,
  40 =&gt; &quot;97dec&quot;, 39 =&gt; &quot;97aug&quot;, 38 =&gt; &quot;97apr&quot;,
  37 =&gt; &quot;96dec&quot;, 36 =&gt; &quot;96jun&quot;, 35 =&gt; &quot;96mar&quot;,
  34 =&gt; &quot;95dec&quot;, 33 =&gt; &quot;95jul&quot;, 32 =&gt; &quot;95apr&quot;,
  31 =&gt; &quot;94dec&quot;, 30 =&gt; &quot;94jul&quot;, 29 =&gt; &quot;94mar&quot;,
  28 =&gt; &quot;93nov&quot;, 27 =&gt; &quot;93jul&quot;, 26 =&gt; &quot;93mar&quot;,
  25 =&gt; &quot;92nov&quot;, 24 =&gt; &quot;92jul&quot;, 23 =&gt; &quot;92mar&quot;,
  22 =&gt; &quot;91nov&quot;, 21 =&gt; &quot;91jul&quot;, 20 =&gt; &quot;91mar&quot;,
  19 =&gt; &quot;90dec&quot; );

my($wgpath) = &quot;/ftp/ietf&quot;;
my($urn) = $ENV{&#39;QUERY_STRING&#39;};
my($host) = $ENV{&#39;SERVER_NAME&#39;}; #get my host name for ftp: URLs
my($accept) = $ENV{&#39;HTTP_ACCEPT&#39;}; #this is the &quot;Accept:&quot; HTTP header

(&amp;resolveid($1), exit) if ($urn =~ /urn:ietf:id:(\S+)/i);
(&amp;resolve1($1, $2), exit) if ($urn =~ /urn:ietf:(\w*):(\d*)/i);
(&amp;resolve2($1, $2), exit) if ($urn =~ /urn:ietf:mtg:(\d*)-(\w*)/i);
&amp;urn_error(&quot;400 Bad Request\n&quot;);

sub resolve2 {
  my($ietfnum, $sesnam) = @_;
  &amp;urn_error(&quot;404 Not Found\n&quot;) if (!defined $number2date{$ietfnum});
  my($date)=$number2date{$ietfnum};
  my($link)=&quot;$wgpath/$sesnam/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {



Moats                        Informational                     [Page 14]

RFC 2648           A URN Namespace for IETF Documents        August 1999


    $link=~s/^\/ftp\///;
    my($ftplink)=&quot;ftp://$host/$link&quot;;
    my($httplink)=&quot;http://$host/$link&quot;;
    my($glink)=&quot;gopher://$host:70/0/$link&quot;;
<font color='red'><s>

    if ($accept =~ /text\/uri-list/) { #look for text/uri-list,
        otherwise text/html
      </s></font></pre><div style='overflow:auto;border:dashed;margin:8px;padding:24px;background-color:#FFFFAF;'><b><i>The preceding text has been updated by Technical <a href='https://www.rfc-editor.org/errata/eid3146'>Errata 3146</a> to instead read:</i></b><pre style='margin:20px'>

    if ($accept =~ /text\/uri-list/) {
        # look for text/uri-list, otherwise text/html

</pre><i><b>Errata Notes: </b>

Appears 4 times in the same section. Might be both editorial and technical error (forced line break in the middle of the comment, making the Perl code invalid)

</i></div><pre>
print &quot;Status: 200 OK\n&quot;;
      print &quot;Content-type: text/uri-list\n\n\n&quot;;
      print &quot;#$urn\n&quot;;
      print &quot;$ftplink\n&quot;;
      print &quot;$httplink\n&quot;;
      print &quot;$glink\n&quot;;
    }
    if ($accept =~ /\*\/\*|text\/html/) {
      print &quot;Status: 200 OK\n&quot;;
      print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
      print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2Ls&lt;/title&gt;&lt;/head&gt;\n&quot;;
      print &quot;&lt;BODY&gt;\n&quot;;
      print &quot;&lt;h1&gt;URN $urn resolves to the following URLs:&lt;/h1&gt;\n&quot;;
      print &quot;&lt;hr&gt;&lt;ul&gt;\n&quot;;
      print &quot;&lt;a href=\&quot;$ftplink\&quot;&gt;$ftplink&lt;/a&gt;\n&quot;;
      print &quot;&lt;a href=\&quot;$httplink\&quot;&gt;$httplink&lt;/a&gt;\n&quot;;
      print &quot;&lt;a href=\&quot;$glink\&quot;&gt;$glink&lt;/a&gt;\n&quot;;
      print &quot;&lt;/UL&gt;\n&lt;/body&gt;\n&lt;/HTML&gt;\n&quot;;
    }
    return;
  }
  my($link)=&quot;$wgpath/$date/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
    $link=~s/^\/ftp\///;
    my($ftplink)=&quot;ftp://$host/$link&quot;;
    my($httplink)=&quot;http://$host/$link&quot;;
    my($glink)=&quot;gopher://$host:70/0/$link&quot;;
    if ($accept =~ /text\/uri-list/) { #look for text/uri-list,
        otherwise text/html
      print &quot;Status: 200 OK\n&quot;;
      print &quot;Content-type: text/uri-list\n\n\n&quot;;
      print &quot;#$urn\n&quot;;
      print &quot;$ftplink\n&quot;;
      print &quot;$httplink\n&quot;;
      print &quot;$glink\n&quot;;
    }
    if ($accept =~ /\*\/\*|text\/html/) {
      print &quot;Status: 200 OK\n&quot;;
      print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
      print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2Ls&lt;/title&gt;&lt;/head&gt;\n&quot;;
      print &quot;&lt;BODY&gt;\n&quot;;



Moats                        Informational                     [Page 15]

RFC 2648           A URN Namespace for IETF Documents        August 1999


      print &quot;&lt;h1&gt;URN $urn resolves to the following URLs:&lt;/h1&gt;\n&quot;;
      print &quot;&lt;hr&gt;&lt;ul&gt;\n&quot;;
      print &quot;&lt;a href=\&quot;$ftplink\&quot;&gt;$ftplink&lt;/a&gt;\n&quot;;
      print &quot;&lt;a href=\&quot;$httplink\&quot;&gt;$httplink&lt;/a&gt;\n&quot;;
      print &quot;&lt;a href=\&quot;$glink\&quot;&gt;$glink&lt;/a&gt;\n&quot;;
      print &quot;&lt;/UL&gt;\n&lt;/body&gt;\n&lt;/HTML&gt;\n&quot;;
    }

    return;
  }
  &amp;urn_error(&quot;404 Not Found\n&quot;);
}

sub resolve1 {
  my($flag,@bib,$i,$k,$j,$done,@ref);
  my($l,$link);
  my($scheme, $value) = @_;
  $scheme =~ tr/A-Z/a-z/;
  &amp;urn_error(&quot;404 Not Found\n&quot;)if (!defined $pathbase{$scheme});
  my($try)=&quot;/ftp/$pathbase{$scheme}$value.txt&quot;;
  if (-f $try) {
    push(@urls, &quot;http://$host/$pathbase{$scheme}$value.txt&quot;);
    push(@urls, &quot;ftp://$host/$pathbase{$scheme}$value.txt&quot;);
    push(@urls, &quot;gopher://$host:70/0/$pathbase{$scheme}$value.txt&quot;);
  }
  $try=&quot;/ftp/$pathbase{$scheme}$value.ps&quot;;
  if (-f $try) {
    push(@urls, &quot;http://$host/$pathbase{$scheme}$value.ps&quot;);
    push(@urls, &quot;ftp://$host/$pathbase{$scheme}$value.ps&quot;);
    push(@urls, &quot;gopher://$host:70/0/$pathbase{$scheme}$value.ps&quot;);
  }
  $try=&quot;/ftp/$pathbase{$scheme}$value.html&quot;;
  if (-f $try) {
    push(@urls, &quot;http://$host/$pathbase{$scheme}$value.html&quot;);
    push(@urls, &quot;ftp://$host/$pathbase{$scheme}$value.html&quot;);
  }

  &amp;urn_error(&quot;404 Not Found\n&quot;) if ($#urls == -1);

MIME_SWITCH: {
    if ($accept =~ /text\/uri-list/) { #look for text/uri-list,
        otherwise text/html
      print &quot;Status: 200 OK\n&quot;;
      print &quot;Content-type: text/uri-list\n\n\n&quot;;
      print &quot;#$urn\n&quot;;
      foreach $i (@urls) {
        print &quot;$i\n&quot;;
      }



Moats                        Informational                     [Page 16]

RFC 2648           A URN Namespace for IETF Documents        August 1999


      last MIME_SWITCH;
    }
    if ($accept =~ /\*\/\*|text\/html/) {
      print &quot;Status: 200 OK\n&quot;;
      print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
      print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2Ls&lt;/title&gt;&lt;/head&gt;\n&quot;;
      print &quot;&lt;BODY&gt;\n&quot;;
      print &quot;&lt;h1&gt;URN $urn resolves to the following URLs:&lt;/h1&gt;\n&quot;;
      print &quot;&lt;hr&gt;&lt;ul&gt;\n&quot;;
      foreach $i (@urls) {
        print &quot;&lt;LI&gt;&lt;A HREF=\&quot;$i\&quot;&gt;$i&lt;/A&gt;\n&quot;;
      }
      print &quot;&lt;/UL&gt;\n&lt;/body&gt;\n&lt;/HTML&gt;\n&quot;;
      last MIME_SWITCH;
    }
  }
}

sub urn_error {
  my($code) = @_; #store failure code here...

  print &quot;Status: $code&quot;;
  print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
  print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2L $code&lt;/title&gt;&lt;/head&gt;\n&quot;;
  print &quot;&lt;BODY&gt;\n&quot;;
  print &quot;&lt;h1&gt;URN to URL resolution failed for the URN:&lt;/h1&gt;\n&quot;;
  print &quot;&lt;hr&gt;&lt;h3&gt;$urn&lt;/h3&gt;\n&quot;;
  print &quot;&lt;/body&gt;\n&quot;;
  print &quot;&lt;/html&gt;\n&quot;;
  exit;
}

sub resolveid {
  my($flag,@bib,$i,$k,$j,$done,@ref);
  my($l,$link);
  my($value) = @_;
  my($scheme) = &quot;id&quot;;
  $scheme =~ tr/A-Z/a-z/;
  &amp;urn_error(&quot;404 Not Found\n&quot;)if (!defined $pathbase{$scheme});
  my($try)=&quot;/ftp/$pathbase{$scheme}$value.txt&quot;;
  if (-f $try) {
    push(@urls, &quot;http://$host/$pathbase{$scheme}$value.txt&quot;);
    push(@urls, &quot;ftp://$host/$pathbase{$scheme}$value.txt&quot;);
    push(@urls, &quot;gopher://$host:70/0/$pathbase{$scheme}$value.txt&quot;);
  }
  $try=&quot;/ftp/$pathbase{$scheme}$value.ps&quot;;
  if (-f $try) {
    push(@urls, &quot;http://$host/$pathbase{$scheme}$value.ps&quot;);



Moats                        Informational                     [Page 17]

RFC 2648           A URN Namespace for IETF Documents        August 1999


    push(@urls, &quot;ftp://$host/$pathbase{$scheme}$value.ps&quot;);
    push(@urls, &quot;gopher://$host:70/0/$pathbase{$scheme}$value.ps&quot;);
  }
  $try=&quot;/ftp/$pathbase{$scheme}$value.html&quot;;
  if (-f $try) {
    push(@urls, &quot;http://$host/$pathbase{$scheme}$value.html&quot;);
    push(@urls, &quot;ftp://$host/$pathbase{$scheme}$value.html&quot;);
  }

  &amp;urn_error(&quot;404 Not Found\n&quot;) if ($#urls == -1);

MIME_SWITCH: {
    if ($accept =~ /text\/uri-list/) { #look for text/uri-list,
        otherwise text/html
      print &quot;Status: 200 OK\n&quot;;
      print &quot;Content-type: text/uri-list\n\n\n&quot;;
      print &quot;#$urn\n&quot;;
      foreach $i (@urls) {
        print &quot;$i\n&quot;;
      }
      last MIME_SWITCH;
    }
    if ($accept =~ /\*\/\*|text\/html/) {
      print &quot;Status: 200 OK\n&quot;;
      print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
      print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2Ls&lt;/title&gt;&lt;/head&gt;\n&quot;;
      print &quot;&lt;BODY&gt;\n&quot;;
      print &quot;&lt;h1&gt;URN $urn resolves to the following URLs:&lt;/h1&gt;\n&quot;;
      print &quot;&lt;hr&gt;&lt;ul&gt;\n&quot;;
      foreach $i (@urls) {
        print &quot;&lt;LI&gt;&lt;A HREF=\&quot;$i\&quot;&gt;$i&lt;/A&gt;\n&quot;;
      }
      print &quot;&lt;/UL&gt;\n&lt;/body&gt;\n&lt;/HTML&gt;\n&quot;;
      last MIME_SWITCH;
    }
  }
}

A.4 I2Ns

#!/usr/local/bin/perl

use strict;

#
# this is a URN 2 URNs resolver for the ietf namespace
#




Moats                        Informational                     [Page 18]

RFC 2648           A URN Namespace for IETF Documents        August 1999


my(%cite) = (
  rfc =&gt; &quot;/ftp/rfc/rfc-index.txt&quot;,
  fyi =&gt; &quot;/ftp/fyi/fyi-index.txt&quot;,
  std =&gt; &quot;/ftp/std/std-index.txt&quot;,
  bcp =&gt; &quot;/ftp/rfc/bcp-index.txt&quot;
);

my(%number2date) = (
  44 =&gt; &quot;99mar&quot;,
  43 =&gt; &quot;98dec&quot;, 42 =&gt; &quot;98aug&quot;, 41 =&gt; &quot;98apr&quot;,
  40 =&gt; &quot;97dec&quot;, 39 =&gt; &quot;97aug&quot;, 38 =&gt; &quot;97apr&quot;,
  37 =&gt; &quot;96dec&quot;, 36 =&gt; &quot;96jun&quot;, 35 =&gt; &quot;96mar&quot;,
  34 =&gt; &quot;95dec&quot;, 33 =&gt; &quot;95jul&quot;, 32 =&gt; &quot;95apr&quot;,
  31 =&gt; &quot;94dec&quot;, 30 =&gt; &quot;94jul&quot;, 29 =&gt; &quot;94mar&quot;,
  28 =&gt; &quot;93nov&quot;, 27 =&gt; &quot;93jul&quot;, 26 =&gt; &quot;93mar&quot;,
  25 =&gt; &quot;92nov&quot;, 24 =&gt; &quot;92jul&quot;, 23 =&gt; &quot;92mar&quot;,
  22 =&gt; &quot;91nov&quot;, 21 =&gt; &quot;91jul&quot;, 20 =&gt; &quot;91mar&quot;,
  19 =&gt; &quot;90dec&quot; );

my($wgpath) = &quot;/ftp/ietf&quot;;
my($urn) = $ENV{&#39;QUERY_STRING&#39;};
my($host) = $ENV{&#39;SERVER_NAME&#39;}; #get my host name for ftp: URLs
my($port) = $ENV={&#39;SERVER_PORT&#39;};
my($accept) = $ENV{&#39;HTTP_ACCEPT&#39;}; #this is the &quot;Accept:&quot; HTTP header

(&amp;resolve1($1, $2), exit) if ($urn =~ /urn:ietf:(\w*):(\d*)/i);
(&amp;resolve2($1, $2), exit) if ($urn =~ /urn:ietf:mtg:(\d*)-(\w*)/i);
&amp;urn_error(&quot;400 Bad Request\n&quot;);

sub resolve2 {
  my($ietfnum, $sesnam) = @_;
  &amp;urn_error(&quot;404 Not Found\n&quot;) if (!defined $number2date{$ietfnum});
  my($date)=$number2date{$ietfnum};
  my($link)=&quot;$wgpath/$sesnam/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
    if ($accept =~ /text\/uri-list/) {
        print &quot;Status: 200 OK\n&quot;;
        print &quot;Content-type: text/uri-list\n\n\n&quot;;
        print &quot;#$urn\n&quot;;
        return;
    }
    if ($accept =~ /\*\/\*|text]\/html/) {
      print &quot;Status: 200 OK\n&quot;;
      print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
      print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2Ns&lt;/title&gt;&lt;/head&gt;\n&quot;;
      print &quot;&lt;BODY&gt;\n&quot;;
      print &quot;&lt;h1&gt;URN $urn resolves to the following URNs:&lt;/h1&gt;\n&quot;;
      print &quot;&lt;hr&gt;&lt;ul&gt;\n&quot;;



Moats                        Informational                     [Page 19]

RFC 2648           A URN Namespace for IETF Documents        August 1999


      print &quot;&lt;/UL&gt;\n&lt;/body&gt;\n&lt;/HTML&gt;\n&quot;;
      return;
    }
  }
  my($link)=&quot;$wgpath/$date/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
    if ($accept =~ /text\/uri-list/) {
        print &quot;Status: 200 OK\n&quot;;
        print &quot;Content-type: text/uri-list\n\n\n&quot;;
        print &quot;#$urn\n&quot;;
        return;
    }
    if ($accept =~ /\*\/\*|text\/html/) {
        print &quot;Status: 200 OK\n&quot;;
        print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
        print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2Ns&lt;/title&gt;&lt;/head&gt;\n&quot;;
        print &quot;&lt;BODY&gt;\n&quot;;
        print &quot;&lt;h1&gt;URN $urn resolves to the following URNs:&lt;/h1&gt;\n&quot;;
        print &quot;&lt;hr&gt;&lt;ul&gt;\n&quot;;
        print &quot;&lt;/UL&gt;\n&lt;/body&gt;\n&lt;/HTML&gt;\n&quot;;
        return;
    }
  }
  &amp;urn_error(&quot;404 Not Found\n&quot;);
}

sub end {
  my($inarg)=@_;
  return $inarg . &quot;st&quot; if ($inarg =~ /1$/);
  return $inarg . &quot;nd&quot; if ($inarg =~ /2$/);
  return $inarg . &quot;rd&quot; if ($inarg =~ /3$/);
  return $inarg . &quot;th&quot;;
}

sub resolve1 {
  my($flag,@bib,$i,$k,$j,$done,@ref);
  my($l,$link);
  my($scheme, $value) = @_;
  $scheme =~ tr/A-Z/a-z/;
  if (!defined $cite{$scheme}) {
    &amp;urn_error(&quot;404 Not Found\n&quot;);
  }

  $flag = 0;
  open(INPUT, &quot;$cite{$scheme}&quot;);
  while (&lt;INPUT&gt;) {
    $flag = 1 if (/^0*$value /);
    if ($flag == 1) {



Moats                        Informational                     [Page 20]

RFC 2648           A URN Namespace for IETF Documents        August 1999


      last if (/^$/);
      chop;
      push @bib,$_;
    }
  }

  $k=join &quot; &quot;,@bib;
  while ($k =~ /(\S*)\s*(fyi|std|rfc|bcp)\s*([0-9]+)(.*)/i) {
    $k=$4;
    $a=$2; $b=$3;
    if (($a ne $scheme || $b ne $value) &amp;&amp; ($1 !~ /obso/i)){
      $a =~ tr/A-Z/a-z/;
      $b =~ s/^0*//;
      push @ref,&quot;urn:ietf:$a:$b&quot;;
    }
  }

MIME_SWITCH: {
    if ($accept =~ /text\/uri-list/) {
        print &quot;Status: 200 OK\n&quot;;
        print &quot;Content-type: text/uri-list\n\n\n&quot;;
        print &quot;#$urn\n&quot;;
        foreach $i (@ref) {
            print &quot;$i\n&quot;;
        }
        last MIME_SWITCH;
    }
  if ($accept =~ /\*\/\*|text\/html/) {
    print &quot;Status: 200 OK\n&quot;;
    print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
    print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2Ns&lt;/title&gt;&lt;/head&gt;\n&quot;;
    print &quot;&lt;BODY&gt;\n&quot;;
    print &quot;&lt;h1&gt;URN $urn resolves to the following URNs:&lt;/h1&gt;\n&quot;;
    print &quot;&lt;hr&gt;&lt;ul&gt;\n&quot;;
        foreach $i (@ref) {
            print &quot;&lt;li&gt;$i: Click to resolve using\n&quot;;
            print &quot;&lt;a
href=\&quot;http://$host:$port/uri-res/I2C?$i\&quot;&gt;I2C&lt;/a&gt;,\n&quot;;
            print &quot;&lt;a
href=\&quot;http://$host:$port/uri-res/I2L?$i\&quot;&gt;I2L&lt;/a&gt;,\n&quot;;
            print &quot;&lt;a
href=\&quot;http://$host:$port/uri-res/I2Ls?$i\&quot;&gt;I2Ls&lt;/a&gt;,\n&quot;;
            print &quot;&lt;a
href=\&quot;http://$host:$port/uri-res/I2R?$i\&quot;&gt;I2R&lt;/a&gt;,\n&quot;;
            print &quot;&lt;a
href=\&quot;http://$host:$port/uri-res/I2Rs?$i\&quot;&gt;I2Rs&lt;/a&gt;\n&quot;;
        }
    print &quot;&lt;/UL&gt;\n&lt;/body&gt;\n&lt;/HTML&gt;\n&quot;;



Moats                        Informational                     [Page 21]

RFC 2648           A URN Namespace for IETF Documents        August 1999


  }
}
}

sub make_link {
  my($sc);
  my($inarg)=@_;
  ($sc=$1) if ($inarg =~ /([a-z]*)/);
  return &quot;/$sc/$inarg.ps&quot; if (-e &quot;/ftp/$sc/$inarg.ps&quot;);
  return &quot;/$sc/$inarg.html&quot; if (-e &quot;/ftp/$sc/$inarg.html&quot;);
  return &quot;/$sc/$inarg.txt&quot;;
}

sub urn_error {
  my($code) = @_; #store failure code here...

  print &quot;Status: $code&quot;;
  print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
  print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2Ns $code&lt;/title&gt;&lt;/head&gt;\n&quot;;
  print &quot;&lt;BODY&gt;\n&quot;;
  print &quot;&lt;h1&gt;URN to URN resolution failed for the URN:&lt;/h1&gt;\n&quot;;
  print &quot;&lt;hr&gt;&lt;h3&gt;$urn&lt;/h3&gt;\n&quot;;
  print &quot;&lt;/body&gt;\n&quot;;
  print &quot;&lt;/html&gt;\n&quot;;
  exit;
};

A.5 I2R

#!/usr/local/bin/perl

use strict;

#
# this is a URN 2 resource resolver for the ietf namespace
#

my(%pathbase) = (
  rfc =&gt; &quot;rfc/rfc&quot;,
  fyi =&gt; &quot;fyi/fyi&quot;,
  std =&gt; &quot;std/std&quot;,
  bcp =&gt; &quot;bcp/bcp&quot;,
  id =&gt; &quot;internet-drafts/draft-&quot;
);

my(%number2date) = (
  44 =&gt; &quot;99mar&quot;,
  43 =&gt; &quot;98dec&quot;, 42 =&gt; &quot;98aug&quot;, 41 =&gt; &quot;98apr&quot;,



Moats                        Informational                     [Page 22]

RFC 2648           A URN Namespace for IETF Documents        August 1999


  40 =&gt; &quot;97dec&quot;, 39 =&gt; &quot;97aug&quot;, 38 =&gt; &quot;97apr&quot;,
  37 =&gt; &quot;96dec&quot;, 36 =&gt; &quot;96jun&quot;, 35 =&gt; &quot;96mar&quot;,
  34 =&gt; &quot;95dec&quot;, 33 =&gt; &quot;95jul&quot;, 32 =&gt; &quot;95apr&quot;,
  31 =&gt; &quot;94dec&quot;, 30 =&gt; &quot;94jul&quot;, 29 =&gt; &quot;94mar&quot;,
  28 =&gt; &quot;93nov&quot;, 27 =&gt; &quot;93jul&quot;, 26 =&gt; &quot;93mar&quot;,
  25 =&gt; &quot;92nov&quot;, 24 =&gt; &quot;92jul&quot;, 23 =&gt; &quot;92mar&quot;,
  22 =&gt; &quot;91nov&quot;, 21 =&gt; &quot;91jul&quot;, 20 =&gt; &quot;91mar&quot;,
  19 =&gt; &quot;90dec&quot; );

my($wgpath) = &quot;/ftp/ietf&quot;;
my($urn) = $ENV{&#39;QUERY_STRING&#39;};
my($host) = $ENV{&#39;SERVER_NAME&#39;}; #get my host name for ftp: URLs
my($accept) = $ENV{&#39;HTTP_ACCEPT&#39;}; #this is the &quot;Accept:&quot; HTTP header

print &quot;$urn\n&quot;;
(&amp;resolveid($1), exit) if ($urn =~ /urn:ietf:id:(\S+)/i);
(&amp;resolve1($1, $2), exit) if ($urn =~ /urn:ietf:(\w*):(\d*)/i);
(&amp;resolve2($1, $2), exit) if ($urn =~ /urn:ietf:mtg:(\d*)-(\w*)/i);
&amp;urn_error(&quot;400 Bad Request\n&quot;);

sub resolve2 {
  my($ietfnum, $sesnam) = @_;
  &amp;urn_error(&quot;404 Not Found\n&quot;) if (!defined $number2date{$ietfnum});
  my($date)=$number2date{$ietfnum};
  my($link)=&quot;$wgpath/$sesnam/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
      print &quot;Status:  200 OK\n&quot;;
      print &quot;Content-type: text/plain\n\n&quot;;
      open(FILE, &quot;$link&quot;);
      while (&lt;FILE&gt;) {
          print $_;
      }
      close FILE;
    return;
  }
  my($link)=&quot;$wgpath/$date/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
      print &quot;Status:  200 OK\n&quot;;
      print &quot;Content-type: text/plain\n\n&quot;;
      open(FILE, &quot;$link&quot;);
      while (&lt;FILE&gt;) {
          print $_;
      }
      close FILE;
    return;
  }
  &amp;urn_error(&quot;404 Not Found\n&quot;);
}



Moats                        Informational                     [Page 23]

RFC 2648           A URN Namespace for IETF Documents        August 1999


sub end {
  my($inarg)=@_;
  return $inarg . &quot;st&quot; if ($inarg =~ /1$/);
  return $inarg . &quot;nd&quot; if ($inarg =~ /2$/);
  return $inarg . &quot;rd&quot; if ($inarg =~ /3$/);
  return $inarg . &quot;th&quot;;
}

sub resolve1 {
  my($flag,@bib,$i,$k,$j,$done,@ref);
  my($l,$link);
  my($scheme, $value) = @_;
  $scheme =~ tr/A-Z/a-z/;
  &amp;urn_error(&quot;404 Not Found\n&quot;)if (!defined $pathbase{$scheme});
  my($txttry)=&quot;/ftp/$pathbase{$scheme}$value.txt&quot;;
  my($pstry)=&quot;/ftp/$pathbase{$scheme}$value.ps&quot;;
  my($htmltry)=&quot;/ftp/$pathbase{$scheme}$value.html&quot;;
MIME_SWITCH: {
    if ($accept =~ /application\/postscript/ &amp;&amp; -f $pstry) {
      print &quot;Status:  200 OK\n&quot;;
      print &quot;Content-type: application/postscript\n\n&quot;;
      open(FILE, &quot;$pstry&quot;);
      while (&lt;FILE&gt;) {
          print $_;
      }
      close FILE;
      last MIME_SWITCH;
    }
    if ($accept =~ /text\/html/ &amp;&amp; -f $htmltry) {
        print &quot;Status:  200 OK\n&quot;;
        print &quot;Content-type: text/html\n\n&quot;;
        open(FILE, &quot;$htmltry&quot;);
        while (&lt;FILE&gt;) {
            print $_;
        }
        close FILE;
        last MIME_SWITCH;
    }
    if ($accept =~ /\*\/\*|text\/plain/ &amp;&amp; -f $txttry) {
        print &quot;Status:  200 OK\n&quot;;
        print &quot;Content-type: text/plain\n\n&quot;;
        open(FILE, &quot;$txttry&quot;);
        while (&lt;FILE&gt;) {
            print $_;
        }
        close FILE;
        last MIME_SWITCH;
    }



Moats                        Informational                     [Page 24]

RFC 2648           A URN Namespace for IETF Documents        August 1999


    &amp;urn_error(&quot;404 Not Found\n&quot;);
  }
}

sub resolveid {
  my($flag,@bib,$i,$k,$j,$done,@ref);
  my($l,$link);
  my($scheme) = &quot;id&quot;;
  my($value) = @_;
  $scheme =~ tr/A-Z/a-z/;
  &amp;urn_error(&quot;404 Not Found\n&quot;)if (!defined $pathbase{$scheme});
  my($txttry)=&quot;/ftp/$pathbase{$scheme}$value.txt&quot;;
  my($pstry)=&quot;/ftp/$pathbase{$scheme}$value.ps&quot;;
  my($htmltry)=&quot;/ftp/$pathbase{$scheme}$value.html&quot;;
MIME_SWITCH: {
    if ($accept =~ /application\/postscript/ &amp;&amp; -f $pstry) {
      print &quot;Status:  200 OK\n&quot;;
      print &quot;Content-type: application/postscript\n\n&quot;;
      open(FILE, &quot;$pstry&quot;);
      while (&lt;FILE&gt;) {
          print $_;
      }
      close FILE;
      last MIME_SWITCH;
    }
    if ($accept =~ /text\/html/ &amp;&amp; -f $htmltry) {
        print &quot;Status:  200 OK\n&quot;;
        print &quot;Content-type: text/html\n\n&quot;;
        open(FILE, &quot;$htmltry&quot;);
        while (&lt;FILE&gt;) {
            print $_;
        }
        close FILE;
        last MIME_SWITCH;
    }
    if ($accept =~ /\*\/\*|text\/plain/ &amp;&amp; -f $txttry) {
        print &quot;Status:  200 OK\n&quot;;
        print &quot;Content-type: text/plain\n\n&quot;;
        open(FILE, &quot;$txttry&quot;);
        while (&lt;FILE&gt;) {
            print $_;
        }
        close FILE;
        last MIME_SWITCH;
    }
    &amp;urn_error(&quot;404 Not Found\n&quot;);
  }
}



Moats                        Informational                     [Page 25]

RFC 2648           A URN Namespace for IETF Documents        August 1999


sub urn_error {
  my($code) = @_; #store failure code here...

  print &quot;Status:  $code&quot;;
  print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
  print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2R $code&lt;/title&gt;&lt;/head&gt;\n&quot;;
  print &quot;&lt;BODY&gt;\n&quot;;
  print &quot;&lt;h1&gt;URN to URL resolution failed for the URN:&lt;/h1&gt;\n&quot;;
  print &quot;&lt;hr&gt;&lt;h3&gt;$urn&lt;/h3&gt;\n&quot;;
  print &quot;&lt;/body&gt;\n&quot;;
  print &quot;&lt;/html&gt;\n&quot;;
  exit;
}

A.6 I2Rs

#!/usr/local/bin/perl

use strict;

#
# this is a URN 2 resources resolver for the ietf namespace
#

my(@urls);

my(%pathbase) = (
  rfc =&gt; &quot;rfc/rfc&quot;,
  fyi =&gt; &quot;fyi/fyi&quot;,
  std =&gt; &quot;std/std&quot;,
  bcp =&gt; &quot;bcp/bcp&quot;,
  id =&gt; &quot;internet-drafts/draft-&quot;
);

my(%number2date) = (
  44 =&gt; &quot;99mar&quot;,
  43 =&gt; &quot;98dec&quot;, 42 =&gt; &quot;98aug&quot;, 41 =&gt; &quot;98apr&quot;,
  40 =&gt; &quot;97dec&quot;, 39 =&gt; &quot;97aug&quot;, 38 =&gt; &quot;97apr&quot;,
  37 =&gt; &quot;96dec&quot;, 36 =&gt; &quot;96jun&quot;, 35 =&gt; &quot;96mar&quot;,
  34 =&gt; &quot;95dec&quot;, 33 =&gt; &quot;95jul&quot;, 32 =&gt; &quot;95apr&quot;,
  31 =&gt; &quot;94dec&quot;, 30 =&gt; &quot;94jul&quot;, 29 =&gt; &quot;94mar&quot;,
  28 =&gt; &quot;93nov&quot;, 27 =&gt; &quot;93jul&quot;, 26 =&gt; &quot;93mar&quot;,
  25 =&gt; &quot;92nov&quot;, 24 =&gt; &quot;92jul&quot;, 23 =&gt; &quot;92mar&quot;,
  22 =&gt; &quot;91nov&quot;, 21 =&gt; &quot;91jul&quot;, 20 =&gt; &quot;91mar&quot;,
  19 =&gt; &quot;90dec&quot; );

my($wgpath) = &quot;/ftp/ietf&quot;;
my($urn) = $ENV{&#39;QUERY_STRING&#39;};



Moats                        Informational                     [Page 26]

RFC 2648           A URN Namespace for IETF Documents        August 1999


my($host) = $ENV{&#39;SERVER_NAME&#39;}; #get my host name for ftp: URLs
my($accept) = $ENV{&#39;HTTP_ACCEPT&#39;}; #this is the &quot;Accept:&quot; HTTP header

(&amp;resolveid($1), exit) if ($urn =~ /urn:ietf:id:(\s*)/i);
(&amp;resolve1($1, $2), exit) if ($urn =~ /urn:ietf:(\w*):(\d*)/i);
(&amp;resolve2($1, $2), exit) if ($urn =~ /urn:ietf:mtg:(\d*)-(\w*)/i);
&amp;urn_error(&quot;400 Bad Request\n&quot;);

sub resolve2 {
  my($ietfnum, $sesnam) = @_;
  my(@vers,$i);
  &amp;urn_error(&quot;404 Not Found\n&quot;) if (!defined $number2date{$ietfnum});
  my($date)=$number2date{$ietfnum};
  my($link)=&quot;$wgpath/$sesnam/$sesnam-minutes-$date.txt&quot;;

  if (-f $link) {
      push(@vers,$link);
  }
  $link=&quot;$wgpath/$date/$sesnam-minutes-$date.txt&quot;;
  if (-f $link) {
      push(@vers,$link);
  }
  &amp;urn_error(&quot;404 Not Found\n&quot;) if ($#vers==-1);

  print &quot;Status: 200 OK\n&quot;;
  print &quot;Content-type: multipart/alternative; boundary=endpart\n\n&quot;;
  foreach $i (@vers) {
      print &quot;--endpart\n&quot;;
      if ($i =~ /html$/) {
          print &quot;Content-Type: text/html\n\n&quot;;
      }
      if ($i =~ /txt$/) {
          print &quot;Content-Type: text/plain\n\n&quot;;
      }
      if ($i =~ /ps$/) {
          print &quot;Content-Type: application/postscript\n\n&quot;;
      }
      open(FILE, &quot;$i&quot;);
      while (&lt;FILE&gt;) {
          print &quot;$_&quot;;
      }
      close FILE;
  }
  print &quot;--endpart\n&quot;;
}

sub resolve1 {
  my($flag,@bib,$i,$k,$j,$done,@ref);



Moats                        Informational                     [Page 27]

RFC 2648           A URN Namespace for IETF Documents        August 1999


  my($l,$link,@vers);
  my($scheme, $value) = @_;
  $scheme =~ tr/A-Z/a-z/;
  &amp;urn_error(&quot;404 Not Found\n&quot;)if (!defined $pathbase{$scheme});
  my($try)=&quot;/ftp/$pathbase{$scheme}$value.txt&quot;;
  if (-f $try) {
      push(@vers, $try);
  }
  $try=&quot;/ftp/$pathbase{$scheme}$value.ps&quot;;
  if (-f $try) {
      push(@vers, $try);
  }
  $try=&quot;/ftp/$pathbase{$scheme}$value.html&quot;;
  if (-f $try) {
      push(@vers, $try);

  }
  print &quot;Status: 200 OK\n&quot;;
  print &quot;Content-type: multipart/alternative; boundary=endpart\n\n&quot;;
  foreach $i (@vers) {
      print &quot;--endpart\n&quot;;
      if ($i =~ /html$/) {
          print &quot;Content-Type: text/html\n\n&quot;;
      }
      if ($i =~ /txt$/) {
          print &quot;Content-Type: text/plain\n\n&quot;;
      }
      if ($i =~ /ps$/) {
          print &quot;Content-Type: application/postscript\n\n&quot;;
      }
      open(FILE, &quot;$i&quot;);
      while (&lt;FILE&gt;) {
          print &quot;$_&quot;;
      }
      close FILE;
  }
  print &quot;--endpart\n&quot;;
}

sub resolveid {
  my($flag,@bib,$i,$k,$j,$done,@ref);
  my($l,$link,@vers);
  my($scheme) = &quot;id&quot;;
  my($value) = @_;
  $scheme =~ tr/A-Z/a-z/;
  &amp;urn_error(&quot;404 Not Found\n&quot;)if (!defined $pathbase{$scheme});
  my($try)=&quot;/ftp/$pathbase{$scheme}$value.txt&quot;;
  if (-f $try) {



Moats                        Informational                     [Page 28]

RFC 2648           A URN Namespace for IETF Documents        August 1999


      push(@vers, $try);
  }
  $try=&quot;/ftp/$pathbase{$scheme}$value.ps&quot;;
  if (-f $try) {
      push(@vers, $try);
  }
  $try=&quot;/ftp/$pathbase{$scheme}$value.html&quot;;
  if (-f $try) {
      push(@vers, $try);
  }
  print &quot;Status: 200 OK\n&quot;;
  print &quot;Content-type: multipart/alternative; boundary=endpart\n\n&quot;;
  foreach $i (@vers) {
      print &quot;--endpart\n&quot;;
      if ($i =~ /html$/) {
          print &quot;Content-Type: text/html\n\n&quot;;

      }
      if ($i =~ /txt$/) {
          print &quot;Content-Type: text/plain\n\n&quot;;
      }
      if ($i =~ /ps$/) {
          print &quot;Content-Type: application/postscript\n\n&quot;;
      }
      open(FILE, &quot;$i&quot;);
      while (&lt;FILE&gt;) {
          print &quot;$_&quot;;
      }
      close FILE;
  }
  print &quot;--endpart\n&quot;;
}
sub urn_error {
  my($code) = @_; #store failure code here...

  print &quot;Status: $code&quot;;
  print &quot;Content-type: text/html\n\n&lt;HTML&gt;\n&quot;;
  print &quot;&lt;head&gt;&lt;title&gt;URN Resolution: I2Rs $code&lt;/title&gt;&lt;/head&gt;\n&quot;;
  print &quot;&lt;BODY&gt;\n&quot;;
  print &quot;&lt;h1&gt;URN to URL resolution failed for the URN:&lt;/h1&gt;\n&quot;;
  print &quot;&lt;hr&gt;&lt;h3&gt;$urn&lt;/h3&gt;\n&quot;;
  print &quot;&lt;/body&gt;\n&quot;;
  print &quot;&lt;/html&gt;\n&quot;;
  exit;
}






Moats                        Informational                     [Page 29]

RFC 2648           A URN Namespace for IETF Documents        August 1999


Full Copyright Statement

   Copyright (C) The Internet Society (1999).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   &quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Moats                        Informational                     [Page 30]

</pre>